<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Tip QR Builder</title>
  <meta name="theme-color" content="#0b0b0f" />
  <style>
    :root{
      --bg:#0b0b0f;
      --panel:#141422;
      --text:#f3f4ff;
      --muted:#a7abcc;
      --border:rgba(255,255,255,.10);
      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --radius:18px;

      --accentA: rgba(120,120,255,.10);
      --accentB: rgba(255,120,200,.08);
      --rainbowOpacity: .55;
      --rainbowOn: 1;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(900px 600px at 10% 0%, var(--accentA), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, var(--accentB), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height: 100vh;
    }

    /* full-screen rainbow layer (optional) */
    body::before{
      content:"";
      position: fixed;
      inset: -35%;
      z-index: 0;
      pointer-events: none;

      background:
        conic-gradient(
          from 0deg,
          rgba(255, 0, 102, .22),
          rgba(255, 153, 0, .18),
          rgba(255, 255, 0, .16),
          rgba(0, 255, 153, .18),
          rgba(0, 204, 255, .20),
          rgba(102, 0, 255, .20),
          rgba(255, 0, 204, .20),
          rgba(255, 0, 102, .22)
        );

      filter: blur(40px) saturate(160%);
      opacity: calc(var(--rainbowOpacity) * var(--rainbowOn));
      animation: rainbowSpin 36s linear infinite, rainbowShift 18s ease-in-out infinite;
    }
    @keyframes rainbowSpin { to { transform: rotate(360deg); } }
    @keyframes rainbowShift {
      0%   { background-position: 0% 50%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    header, .wrap, footer, .adminShell{
      position: relative;
      z-index: 1;
    }

    header{
      padding: 28px 18px 10px;
      text-align:center;
    }

    /* Logo */
    .logoWrap{
      display:flex;
      justify-content:center;
      align-items:center;
      margin: 0 auto 10px;
    }
    .logoImg{
      width: 132px;
      height: auto;
      max-width: 70vw;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      box-shadow: 0 16px 44px rgba(0,0,0,.45);
      padding: 10px;
      display:none;
    }

    h1{
      margin:0;
      font-size: 28px;
      letter-spacing:.3px;
    }
    .sub{
      margin:10px auto 0;
      max-width: 760px;
      color:var(--muted);
      line-height:1.45;
      font-size:14px;
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
    }

    .tip-joke{
      margin: 12px auto 0;
      max-width: 860px;

      font-style: normal;
      font-weight: 900;
      font-size: clamp(18px, 2.2vw, 26px);
      line-height: 1.25;
      letter-spacing: .2px;

      color: rgba(255,255,255,.96);

      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(10px);

      box-shadow:
        0 10px 26px rgba(0,0,0,.45),
        0 0 0 1px rgba(255,255,255,.06) inset,
        0 0 22px rgba(255,255,255,.10);

      text-shadow:
        0 2px 10px rgba(0,0,0,.55),
        0 0 18px rgba(255,255,255,.14);

      transition: opacity .25s ease, transform .25s ease, filter .25s ease;
    }
    .tip-joke.fadeout{
      opacity: 0;
      transform: translateY(-4px) scale(.99);
      filter: blur(1px);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
      margin-top: 18px;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      position: relative;
      overflow:hidden;
      backdrop-filter: blur(8px);
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-1px;
      background: radial-gradient(600px 200px at 30% 0%, rgba(255,255,255,.06), transparent 60%);
      pointer-events:none;
    }
    .row{
      position:relative;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .info{
      flex: 1 1 auto;
      min-width: 0;
    }
    .title{
      font-size: 18px;
      font-weight: 700;
      margin: 0;
    }
    .hint{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .qr{
      position:relative;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 14px;
      padding: 10px;
      width: 148px;
      height: 148px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex: 0 0 auto;
    }
    .link{
      position:relative;
      margin-top: 12px;
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    a{
      color: #cdd1ff;
      text-decoration: none;
      word-break: break-all;
      font-size: 13px;
      padding: 6px 0;
      display: inline-block;
    }
    a:hover{ text-decoration: underline; }

    button, .btn{
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      color: var(--text);
      padding: 9px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 700;
      font-size: 13px;
      min-height: 44px;
    }
    button:hover, .btn:hover{ background: rgba(255,255,255,.14); }

    footer{
      text-align:center;
      color: var(--muted);
      font-size: 12px;
      padding: 18px 18px 28px;
    }
    .tiny{ opacity:.9; }

    /* Admin UI */
    .adminShell{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 18px 34px;
    }
    .adminTop{
      display:flex;
      gap: 12px;
      align-items:center;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.9);
      font-weight: 800;
    }
    .adminGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 16px;
    }
    .panel{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(0,0,0,.18);
      box-shadow: var(--shadow);
      padding: 14px;
      backdrop-filter: blur(10px);
    }
    .panel h2{
      margin: 0 0 10px;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .field{
      display:flex;
      flex-direction: column;
      gap: 6px;
      margin: 10px 0;
    }
    label{
      font-size: 12px;
      color: var(--muted);
      font-weight: 800;
      letter-spacing:.2px;
    }
    input, textarea, select{
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline: none;
      font-weight: 700;
    }
    textarea{ min-height: 92px; resize: vertical; font-weight: 700; line-height: 1.35; }
    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .row3{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }
    .mutedNote{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.35;
      margin-top: 8px;
    }
    .list{
      display:flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }
    .item{
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 14px;
      background: rgba(255,255,255,.04);
      padding: 12px;
      display:flex;
      flex-direction: column;
      gap: 10px;
    }
    .itemTop{
      display:flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .tag{
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,.9);
      opacity: .95;
    }
    .itemBtns{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .danger{ border-color: rgba(255,80,120,.45); }
    .danger:hover{ background: rgba(255,80,120,.12); }

    .ok{ border-color: rgba(80,255,170,.35); }
    .ok:hover{ background: rgba(80,255,170,.12); }

    .small{
      font-size: 12px;
      font-weight: 800;
      opacity: .95;
    }

    /* Admin logo preview */
    .logoAdminRow{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .logoPreview{
      width: 88px;
      height: 88px;
      object-fit: contain;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      padding: 8px;
    }

    @media (max-width: 900px) {
      .adminGrid{ grid-template-columns: 1fr; }
      .qr { width: 132px; height: 132px; }
    }
    @media (max-width: 520px) {
      .row {
        flex-direction: column;
        align-items: center;
        text-align: center;
      }
      .info { width: 100%; }
      .title { font-size: 20px; }
      .hint {
        white-space: normal;
        text-overflow: unset;
        overflow: visible;
        word-break: break-word;
      }
      .qr {
        width: 180px;
        height: 180px;
        margin-bottom: 12px;
      }
      .link {
        flex-direction: column;
        gap: 10px;
      }
      .link a { font-size: 14px; }
      button { width: 100%; padding: 12px; font-size: 14px; }
      .logoImg{ width: 150px; }
    }
  </style>
</head>

<body>
  <!-- PUBLIC VIEW -->
  <header id="publicHeader">
    <div class="logoWrap">
      <img id="pageLogo" class="logoImg" alt="Logo" />
    </div>
    <h1 id="pageTitle">Tip Petesimple - QR Codes</h1>
    <p id="pageSubtitle" class="sub">Scan a code, send a tip, keep the music moving.</p>
    <p id="tipJoke" class="sub tip-joke"></p>
  </header>

  <div id="publicWrap" class="wrap">
    <div id="grid" class="grid"></div>
  </div>

  <footer id="publicFooter">
    <div class="tiny">Built for quick scanning on phones. Works great on a tablet at the merch table too.</div>
  </footer>

  <!-- ADMIN VIEW -->
  <div id="admin" class="adminShell" style="display:none;">
    <div class="adminTop">
      <div class="pill">Admin Mode - Tip Jar Builder</div>
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button id="btnViewPublic" class="ok">Open Public View</button>
        <button id="btnCopyPublicLink">Copy Public Link</button>
        <button id="btnResetDefault" class="danger">Reset to Petesimple Default</button>
      </div>
    </div>

    <div class="adminGrid">
      <div class="panel">
        <h2>Page Settings</h2>

        <div class="row2">
          <div class="field">
            <label>Page Title</label>
            <input id="inTitle" type="text" />
          </div>
          <div class="field">
            <label>Genre (shows in jokes)</label>
            <select id="inGenre"></select>
          </div>
        </div>

        <div class="field">
          <label>Page Subtitle</label>
          <input id="inSubtitle" type="text" />
        </div>

        <h2 style="margin-top:16px;">Logo</h2>
        <div class="row2">
          <div class="field">
            <label>Show Logo</label>
            <select id="inLogoOn">
              <option value="on">On</option>
              <option value="off">Off</option>
            </select>
          </div>
          <div class="field">
            <label>Logo Mode</label>
            <select id="inLogoMode">
              <option value="default">Default (logo.png)</option>
              <option value="url">URL</option>
              <option value="upload">Upload (saved in config)</option>
            </select>
          </div>
        </div>

        <div class="field" id="logoUrlField">
          <label>Logo URL</label>
          <input id="inLogoUrl" type="text" placeholder="https://example.com/logo.png or ./logo.png" />
          <div class="mutedNote">Tip: keep it square-ish. PNG with transparent background looks awesome.</div>
        </div>

        <div class="field" id="logoUploadField">
          <label>Upload Logo</label>
          <input id="inLogoFile" type="file" accept="image/*" />
          <div class="mutedNote">This stores the image inside the config so it works even if the artist does not commit files.</div>
        </div>

        <div class="logoAdminRow">
          <img id="logoPreview" class="logoPreview" alt="Logo preview" />
          <button id="btnLogoClear" class="danger">Clear Uploaded Logo</button>
        </div>

        <h2 style="margin-top:16px;">Background</h2>
        <div class="row3">
          <div class="field">
            <label>Rainbow Layer</label>
            <select id="inRainbow">
              <option value="on">On</option>
              <option value="off">Off</option>
            </select>
          </div>
          <div class="field">
            <label>Theme Accent</label>
            <select id="inTheme">
              <option value="neon">Neon</option>
              <option value="midnight">Midnight</option>
              <option value="sunset">Sunset</option>
              <option value="ice">Ice</option>
              <option value="mono">Mono</option>
            </select>
          </div>
          <div class="field">
            <label>Rainbow Opacity</label>
            <input id="inRainbowOpacity" type="number" min="0" max="1" step="0.05" />
          </div>
        </div>

        <h2 style="margin-top:16px;">Tip Jokes</h2>
        <div class="row3">
          <div class="field">
            <label>Jokes Enabled</label>
            <select id="inJokesOn">
              <option value="on">On</option>
              <option value="off">Off</option>
            </select>
          </div>
          <div class="field">
            <label>Rotate Every (seconds)</label>
            <input id="inJokeEvery" type="number" min="5" step="1" />
          </div>
         
